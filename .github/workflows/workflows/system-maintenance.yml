# Nome atualizado para refletir a nova realidade
name: Manutencao Diaria do Sistema

# Gatilho (trigger): como o job é acionado
on:
  schedule:
    # Executa todos os dias às 5h da manhã no fuso horário UTC.
    - cron: "0 5 * * *"
  # Permite rodar manualmente pela interface do GitHub (útil para testes)
  workflow_dispatch:

# Tarefas que serão executadas
jobs:
  maintenance:
    runs-on: ubuntu-latest

    steps:
      - name: Chamar endpoint de manutencao (Limpeza de Sessoes)
        env:
          SITE_URL: ${{ secrets.SITE_URL }}
          CRON_SECRET: ${{ secrets.CRON_SECRET }}
        run: |
          curl --request GET \
            --url "$SITE_URL/api/cron" \
            --header "Authorization: Bearer $CRON_SECRET"
